<% if @product.subscribable || @product.variants.any?(&:subscribable)%>
  <%= content_tag :h3, t('.subscription_fields') %>
  <%= fields_for :'subscription_line_item', SolidusSubscriptions::LineItem.new do |ff| %>
    <div>
      <%= ff.label :interval_length, t('.interval_length') %>
      <%= ff.number_field :interval_length, value: 1 %>

      <%= ff.collection_radio_buttons :interval_units, SolidusSubscriptions::LineItem.interval_units.to_a, :first, :first, { checked: SolidusSubscriptions::LineItem.interval_units.to_a.first } %>
    </div>

    <%= ff.hidden_field :quantity %>
    <%= ff.hidden_field :subscribable_id %>
  <% end %>

  <script>
    document.addEventListener("DOMContentLoaded", function(e) {
      var cartForm = document.querySelector('#cart-form form');

      cartForm.addEventListener('submit', function(e) {
        var solidusQuantityInput = e.target.querySelector('[name*="quantity"]');
        var quantityInput = e.target.querySelector('[name*="subscription_line_item[quantity]"]');
        var variantInput = e.target.querySelector('[name*="variant_id"]');
        var subscribableInput = e.target.querySelector('[name*="subscribable_id"]');

        quantityInput.value = solidusQuantityInput.value;
        subscribableInput.value = variantInput.value;

        return true;
      });
    });
  </script>
<% end %>
